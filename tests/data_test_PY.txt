################################################################################
# HƯỚNG DẪN SỬ DỤNG:
# 1. Copy toàn bộ nội dung của một TEST CASE (từ dòng "N = ..." đến hết "d = ...")
# 2. Dán đè vào phần đầu của file 'wiener_ref.py'.
# 3. Chạy file Python để xem kết quả "Filtered output" và "MMSE" chuẩn.
################################################################################

# ==============================================================================
# TEST 1: CƠ BẢN (DEFAULT)
# Mục đích: Dữ liệu thực ngẫu nhiên, độ chính xác cao.
# ==============================================================================
N = 10
M = 3
h = [
    0.8568918466567993, 0.5583352744579315, 0.2105703055858612
]
x = [
    0.8999999761581421, 0.30000001192092896, 0.699999988079071, 
    1.5, 1.399999976158142, 0.10000000149011612, 
    1.2000000476837158, 0.699999988079071, 0.699999988079071, 
    1.100000023841858
]
d = [
    0.0, 0.10000000149011612, 0.20000000298023224, 
    0.4000000059604645, 0.5, 0.6000000238418579, 
    0.699999988079071, 0.800000011920929, 0.800000011920929, 
    0.8999999761581421
]


# ==============================================================================
# TEST 2: ĐỒNG NHẤT (IDENTITY FILTER)
# Mục đích: Output phải giống hệt Input. MMSE = 0.0.
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]
d = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]


# ==============================================================================
# TEST 3: SỐ ÂM (MIXED SIGNS)
# Mục đích: Kiểm tra xử lý số âm. MMSE = 0.0.
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [1.0, -1.0, 2.0, -2.0, 3.0, -3.0, 4.0, -4.0, 5.0, -5.0]
d = [1.0, -1.0, 2.0, -2.0, 3.0, -3.0, 4.0, -4.0, 5.0, -5.0]


# ==============================================================================
# TEST 4: SỐ 0 (ALL ZEROS)
# Mục đích: Kiểm tra tín hiệu bằng 0. Output = 0, MMSE = 0.
# ==============================================================================
N = 10
M = 3
h = [0.5, 0.2, 0.1]
x = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
d = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]


# ==============================================================================
# TEST 5: LÀM TRÒN SỐ (ROUNDING EDGE CASE)
# Mục đích: Kiểm tra logic làm tròn biên (1.25 -> 1.3).
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [1.25, 1.35, 1.45, 1.55, 1.65, 1.75, 1.85, 1.95, 2.05, 2.15]
d = [1.25, 1.35, 1.45, 1.55, 1.65, 1.75, 1.85, 1.95, 2.05, 2.15]


# ==============================================================================
# TEST 6: NHIỄU TRẮNG (WHITE NOISE)
# Mục đích: Sóng Sin chuẩn + Nhiễu ngẫu nhiên.
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [0.1, 0.109, 0.588, 1.009, 0.851, 1.1, 0.751, 0.809, 0.788, 0.209]
d = [0.0, 0.309, 0.588, 0.809, 0.951, 1.0, 0.951, 0.809, 0.588, 0.309]


# ==============================================================================
# TEST 7: NHIỄU HỒNG (PINK NOISE)
# Mục đích: Sóng Sin + Nhiễu tương quan (biến đổi chậm).
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [0.2, 0.459, 0.688, 0.809, 0.851, 0.8, 0.801, 0.809, 0.688, 0.109]
d = [0.0, 0.309, 0.588, 0.809, 0.951, 1.0, 0.951, 0.809, 0.588, 0.309]


# ==============================================================================
# TEST 8: NHIỄU THẤP (LOW NOISE)
# Mục đích: Sai số rất bé. MMSE hiển thị ~ 0.0.
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [0.02, 0.39, 0.70, 1.05, 1.25, 1.45, 1.48, 1.45, 1.30, 1.00]
d = [0.0, 0.37, 0.72, 1.03, 1.28, 1.43, 1.50, 1.43, 1.28, 1.03]


# ==============================================================================
# TEST 9: NHIỄU CAO (HIGH NOISE)
# Mục đích: Sai số lớn. MMSE hiển thị ~ 0.4.
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [0.8, -0.4, 1.3, 0.1, 1.7, 0.3, 1.6, 0.0, 1.3, -0.4]
d = [0.0, 0.309, 0.588, 0.809, 0.951, 1.0, 0.951, 0.809, 0.588, 0.309]


# ==============================================================================
# TEST 10: AN TOÀN (SAFETY CASE - RUBRIC)
# Mục đích: Đảm bảo MMSE = 0.16 (Hiển thị 0.2) 
# ==============================================================================
N = 10
M = 3
h = [1.0, 0.0, 0.0]
x = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0]
d = [1.4, 2.4, 3.4, 4.4, 5.4, 6.4, 7.4, 8.4, 9.4, 10.4]